# 优化策略（H-Priority with Reservation）逻辑说明

## 1. 问题结构
- B 机是瓶颈资源，H 类必须在 B 机加工。
- N 类可在 A 或 B 加工，但若 N 占用 B，会直接推迟 H 的加工启动，导致 H 拖期上升。

## 2. 设计思想
核心思想是“保留 B 给 H，只有在安全空闲时才允许 N 占用 B”。
这本质上是一个 **瓶颈资源保护机制**：
- 对 H 的目标函数权重更高（最小化 H 平均拖期）。
- 对 N 则通过 A 机消化为主，降低对 B 的干扰。

## 3. 规则定义
### 3.1 绝对优先权
B 机队列上，H 类订单拥有绝对优先权：
- 若 B 忙，H 进入高优先级队列（优先级数值更小）。
- 若 B 空闲，H 立即抢占加工。

### 3.2 预留逻辑（Reservation）
对 N 类订单，当满足以下条件时，允许其进入 B：
1. **A 机负载很高**：A 队列长度（含在制）≥ 阈值 $A\_BUSY\_THRESHOLD$。
2. **B 机近期安全**：预测未来 $B\_RESERVATION\_WINDOW$ 时间内无 H 到达。
3. **B 机当前无积压**：B 队列与在制数量为 0。

否则，N 默认进入 A 队列。

## 4. 为什么有效
- H 必须在 B 上完成，因此 B 的“可用时间”直接决定 H 的拖期。
- N 即使在 A 上慢一些，其拖期增加对目标影响较小（次要目标）。
- 只有当 A 明显拥堵且 B 安全空闲时，才让 N 使用 B，从而避免 **N 占 B 导致 H 延迟**。

## 5. 数学动机（简要）
- 单机情况下 SPT/WSPT 可最小化平均流程时间，但本问题瓶颈资源是 B。
- 采用优先级规则与预留窗口，相当于对 H 类订单在 B 机上施加更高权重，
  从而降低 H 的平均拖期，满足核心目标。
